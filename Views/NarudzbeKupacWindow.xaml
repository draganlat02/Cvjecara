<Window x:Class="PrviProjekat.Views.NarudzbeKupacWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="{DynamicResource CustomerOrders_Title}"
        Height="650" Width="1100"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BackgroundBrush}"
        FontFamily="{DynamicResource MainFont}">

    <Window.Resources>
        <sys:String x:Key="Status_Pending">U obradi</sys:String>
        <sys:String x:Key="Status_Completed">Završeno</sys:String>
        <sys:String x:Key="Status_Canceled">Otkazano</sys:String>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- FILTERI + PRETRAGA -->
        <Border Grid.Row="0"
                Background="{DynamicResource PanelBackground}"
                CornerRadius="12"
                Padding="18"
                Margin="0,0,0,18"
                BorderBrush="#E0E0E0"
                BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- PRETRAGA -->
                <TextBox x:Name="SearchKupacTextBox" 
         Width="280" Height="40" Margin="0,0,20,0"
         FontSize="14" Padding="12,0"
         VerticalAlignment="Center"
         Text="{Binding SearchKupac, UpdateSourceTrigger=PropertyChanged, Delay=300}"
         Tag="{DynamicResource CustomerOrders_SearchPlaceholder}">

                    <TextBox.Style>
                        <Style TargetType="TextBox">
                            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                            <Setter Property="Background" Value="{DynamicResource PanelBackground}"/>
                            <Setter Property="BorderBrush" Value="#CCCCCC"/>
                            <Setter Property="BorderThickness" Value="1"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TextBox">
                                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="10">
                                            <Grid>
                                                <ScrollViewer x:Name="PART_ContentHost" Margin="2"/>
                                                <TextBlock Text="{TemplateBinding Tag}"
                                           Foreground="Gray"
                                           FontSize="14"
                                           Margin="12,0,0,0"
                                           VerticalAlignment="Center"
                                           IsHitTestVisible="False"
                                           Opacity="0.7">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource TemplatedParent}}" Value="">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource TemplatedParent}}" Value="{x:Null}">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsKeyboardFocused" Value="True">
                                    <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TextBox.Style>
                </TextBox>

                <!-- DUGMAD + PERIOD -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- U OBRADI -->
                    <!-- U OBRADI -->
                    <Button x:Name="BtnPending" 
        Content="{DynamicResource CustomerOrders_Filter_Pending}" 
        Click="Obradi_Click"
        Width="110" Height="40" Margin="0,0,10,0"
        Background="#F39C12" Foreground="White" FontWeight="Bold">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border"
                    Background="#F39C12"
                    CornerRadius="10"
                    BorderBrush="#2C3E50"
                    BorderThickness="3">
                                    <!-- AKTIVNO = debela tamna ivica -->
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#e67e22"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#d35400"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <!-- ZAVRŠENO -->
                    <Button x:Name="BtnCompleted" 
        Content="{DynamicResource CustomerOrders_Filter_Completed}" 
        Click="Zavrsene_Click"
        Width="110" Height="40" Margin="0,0,10,0"
        Background="#27AE60" Foreground="White">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border"
                    Background="#27AE60"
                    CornerRadius="10"
                    BorderBrush="#27AE60"
                    BorderThickness="2">
                                    <!-- NEAKTIVNO = ivica iste boje kao pozadina (gotovo nevidljiva) -->
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#2ecc71"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#229954"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <!-- OTKAZANO -->
                    <Button x:Name="BtnCanceled" 
        Content="{DynamicResource CustomerOrders_Filter_Canceled}" 
        Click="Otkazane_Click"
        Width="110" Height="40" Margin="0,0,20,0"
        Background="#E74C3C" Foreground="White">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border"
                    Background="#E74C3C"
                    CornerRadius="10"
                    BorderBrush="#E74C3C"
                    BorderThickness="2">
                                    <!-- NEAKTIVNO -->
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#ec7063"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#c0392b"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <!-- PERIOD COMBOBOX -->
                    <ComboBox x:Name="PeriodComboBox"
          Width="220" Height="40"
          FontSize="13" SelectedIndex="0"
          SelectionChanged="PeriodComboBox_SelectionChanged"
          BorderBrush="#CCCCCC" BorderThickness="1"
          Background="{DynamicResource PanelBackground}">
                        <ComboBoxItem Content="{DynamicResource CustomerOrders_Period_7Days}"    Tag="7"     IsSelected="True"/>
                        <ComboBoxItem Content="{DynamicResource CustomerOrders_Period_14Days}"   Tag="14"    />
                        <ComboBoxItem Content="{DynamicResource CustomerOrders_Period_30Days}"   Tag="30"    />
                        <ComboBoxItem Content="{DynamicResource CustomerOrders_Period_6Months}"  Tag="180"   />
                        <ComboBoxItem Content="{DynamicResource CustomerOrders_Period_1Year}"    Tag="365"   />
                        <Separator/>
                        <ComboBoxItem Content="{DynamicResource CustomerOrders_Period_All}"      Tag="all"   FontWeight="Bold"/>
                    </ComboBox>
                </StackPanel>
            </Grid>
        </Border>

        <!-- TABELA NARUDŽBI -->
        <DataGrid x:Name="OrdersGrid" Grid.Row="1"
                  AutoGenerateColumns="False" IsReadOnly="True"
                  AlternatingRowBackground="{DynamicResource PanelBackground}"
                  RowHeaderWidth="0" HeadersVisibility="Column"
                  GridLinesVisibility="Horizontal"
                  BorderBrush="#E0E0E0" BorderThickness="1"
                  Background="{DynamicResource PanelBackground}"
                  MouseDoubleClick="OrdersGrid_MouseDoubleClick"
                  Cursor="Hand">
            <DataGrid.Columns>
                <!-- KUPCA -->
                <DataGridTextColumn Header="{DynamicResource CustomerOrders_Column_Customer}" Binding="{Binding Kupac}" Width="170">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!-- DATUM -->
                <DataGridTextColumn Header="{DynamicResource CustomerOrders_Column_Date}" Binding="{Binding Datum}" Width="140">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!-- STATUS -->
                <DataGridTextColumn Header="{DynamicResource CustomerOrders_Column_Status}" Binding="{Binding Status}" Width="110">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Medium"/>
                            <Setter Property="HorizontalAlignment" Value="Center"/>
                            <Setter Property="Foreground" Value="{DynamicResource SuccessBrush}"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Status}" Value="{StaticResource Status_Canceled}">
                                    <Setter Property="Foreground" Value="{DynamicResource DangerBrush}"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Status}" Value="{StaticResource Status_Pending}">
                                    <Setter Property="Foreground" Value="#F39C12"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!-- UKUPNO -->
                <DataGridTextColumn Header="{DynamicResource CustomerOrders_Column_Total}" Binding="{Binding Ukupno}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="Foreground" Value="{DynamicResource SuccessBrush}"/>
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                            <Setter Property="Margin" Value="0,0,12,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!-- STAVKE -->
                <DataGridTextColumn Header="{DynamicResource CustomerOrders_Column_Items}" Binding="{Binding Stavke}" Width="200">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                            <Setter Property="TextWrapping" Value="Wrap"/>
                            <Setter Property="MaxHeight" Value="70"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!-- NAPOMENA -->
                <DataGridTextColumn Header="{DynamicResource CustomerOrders_Column_Note}" Binding="{Binding Napomena}" Width="150">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                            <Setter Property="FontWeight" Value="Medium"/>
                            <Setter Property="TextWrapping" Value="Wrap"/>
                            <Setter Property="MaxHeight" Value="70"/>
                            <Setter Property="ToolTip" Value="{Binding Napomena}"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Napomena}" Value="">
                                    <Setter Property="Text" Value="—"/>
                                    <Setter Property="Foreground" Value="#BDC3C7"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Napomena}" Value="{x:Null}">
                                    <Setter Property="Text" Value="—"/>
                                    <Setter Property="Foreground" Value="#BDC3C7"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
            </DataGrid.Columns>

            <!-- PRAZAN TEMPLATE -->
            <DataGrid.Style>
                <Style TargetType="DataGrid">
                    <Setter Property="ItemsSource" Value="{Binding NarudzbePrikaz}"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding NarudzbePrikaz.Count}" Value="0">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <Border Background="{DynamicResource PanelBackground}"
                                                BorderBrush="#E0E0E0"
                                                BorderThickness="1"
                                                CornerRadius="14"
                                                Margin="30"
                                                Padding="30">
                                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                                <TextBlock Text="{DynamicResource CustomerOrders_Empty_Title}"
                                                           FontSize="17"
                                                           Foreground="{DynamicResource TextBrush}"
                                                           FontStyle="Italic"
                                                           FontWeight="Medium"
                                                           HorizontalAlignment="Center"/>
                                                <TextBlock Text="{DynamicResource CustomerOrders_Empty_Subtitle}"
                                                           FontSize="13"
                                                           Foreground="#BDC3C7"
                                                           Margin="0,8,0,0"
                                                           HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.Style>
        </DataGrid>
    </Grid>
</Window>