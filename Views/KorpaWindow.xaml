<Window x:Class="PrviProjekat.Views.KorpaWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="{DynamicResource Cart_Title}"
        Height="560" Width="780"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BackgroundBrush}"
        FontFamily="{DynamicResource MainFont}"
        Loaded="Window_Loaded">
    
    <Border CornerRadius="12"
            Background="{DynamicResource PanelBackground}"
            Padding="22"
            Margin="16"
            BorderBrush="#E0E0E0"
            BorderThickness="1">
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- PRAZNA KORPA -->
            <StackPanel x:Name="EmptyCartPanel"
                        Grid.Row="0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Margin="0,0,0,20"
                        Visibility="Collapsed">
                <TextBlock Text="{DynamicResource Cart_Empty_Title}"
                           FontSize="22"
                           Foreground="{DynamicResource TextBrush}"
                           Opacity="0.7"
                           FontWeight="Medium"
                           HorizontalAlignment="Center"/>
                <TextBlock Text="{DynamicResource Cart_Empty_Subtitle}"
                           FontSize="15"
                           Foreground="{DynamicResource TextBrush}"
                           Opacity="0.5"
                           Margin="0,10,0,0"
                           HorizontalAlignment="Center"/>
            </StackPanel>

            <!-- LISTA PROIZVODA -->
            <ListView x:Name="CartList"
                      Grid.Row="0"
                      Margin="0,0,0,18"
                      BorderThickness="0"
                      AlternationCount="2"
                      Background="Transparent"
                      ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="{DynamicResource Cart_Column_Product}" 
                                        DisplayMemberBinding="{Binding Naziv}" Width="230"/>
                        <GridViewColumn Header="{DynamicResource Cart_Column_Price}" 
                                        DisplayMemberBinding="{Binding Cijena, StringFormat='{}{0:F2}'}" Width="100"/>
                        <GridViewColumn Header="{DynamicResource Cart_Column_Quantity}" Width="140">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button Content="−" 
                                                Width="28" Height="28" Margin="0,0,5,0"
                                                Background="{DynamicResource PanelBackground}"
                                                BorderBrush="#CCCCCC" BorderThickness="1"
                                                FontWeight="Bold" Cursor="Hand"
                                                Click="DecreaseQuantity_Click"
                                                Tag="{Binding}">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                            CornerRadius="6"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="1">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="{DynamicResource AccentHover}"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                        <TextBlock Text="{Binding Kolicina}"
                                                   Width="40" TextAlignment="Center" 
                                                   VerticalAlignment="Center"
                                                   FontWeight="SemiBold"
                                                   Foreground="{DynamicResource TextBrush}"/>
                                        <Button Content="+" 
                                                Width="28" Height="28" Margin="5,0,0,0"
                                                Background="{DynamicResource PanelBackground}"
                                                BorderBrush="#CCCCCC" BorderThickness="1"
                                                FontWeight="Bold" Cursor="Hand"
                                                Click="IncreaseQuantity_Click"
                                                Tag="{Binding}">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                            CornerRadius="6"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="1">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="{DynamicResource SuccessHover}"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                    </StackPanel>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="{DynamicResource Cart_Column_Total}" 
                                        DisplayMemberBinding="{Binding Ukupno, StringFormat='{}{0:F2}'}" Width="110"/>
                        <GridViewColumn Header="{DynamicResource Cart_Column_Remove}" Width="90">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Content="{DynamicResource Cart_RemoveBtn}"
                                            Width="70" Height="32"
                                            Background="{DynamicResource DangerBrush}"
                                            Foreground="White"
                                            FontWeight="Medium"
                                            BorderThickness="0"
                                            Cursor="Hand"
                                            Tag="{Binding}"
                                            Click="RemoveItem_Click">
                                        <Button.Template>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}" CornerRadius="8">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="{DynamicResource DangerHover}"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                    </GridView>
                </ListView.View>
            </ListView>

            <!-- DONJI PANEL -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="3*"/>
                    <ColumnDefinition Width="2*"/>
                </Grid.ColumnDefinitions>

                <!-- LIJEVO: IME I NAPOMENA -->
                <StackPanel Grid.Column="0" Margin="0,0,25,0">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <TextBlock Text="{DynamicResource Cart_CustomerName}"
                                   FontWeight="Bold"
                                   VerticalAlignment="Center"
                                   Margin="0,0,12,0"
                                   Foreground="{DynamicResource TextBrush}"/>
                        <TextBox x:Name="ImeKupcaTextBox"
                                 Width="240" Height="36"
                                 BorderBrush="#CCCCCC" BorderThickness="1"
                                 Background="White"
                                 Padding="10,0"
                                 FontSize="14"
                                 ToolTip="{DynamicResource Cart_CustomerName_Tooltip}"/>
                    </StackPanel>
                    <TextBlock Text="{DynamicResource Cart_Note}"
                               FontWeight="Bold"
                               Margin="0,0,0,4"
                               Foreground="{DynamicResource TextBrush}"/>
                    <TextBox x:Name="NapomenaTextBox"
                             Height="60"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             BorderBrush="#CCCCCC"
                             BorderThickness="1"
                             Background="White"
                             Padding="10"
                             FontSize="14"/>
                </StackPanel>

                <!-- DESNO: UKUPNO + DUGME -->
                <StackPanel Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Top">
                    <TextBlock x:Name="TotalText"
                               Text="Ukupno: 0.00 KM"
                               FontWeight="Bold" FontSize="20"
                               Foreground="{DynamicResource SuccessBrush}"
                               Margin="0,0,0,15"
                               HorizontalAlignment="Right"/>
                    <Button Content="{DynamicResource Cart_FinishBtn}"
                            Width="200" Height="48"
                            Background="{DynamicResource SuccessBrush}"
                            Foreground="White"
                            FontWeight="SemiBold"
                            FontSize="15"
                            BorderThickness="0"
                            Cursor="Hand"
                            HorizontalAlignment="Right"
                            Click="Finish_Click">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}"
                                        CornerRadius="12">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="{DynamicResource SuccessHover}"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>