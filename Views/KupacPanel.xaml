<Window x:Class="PrviProjekat.Views.KupacPanel"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="{DynamicResource Customer_Panel_Title}"
        Height="720" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource BackgroundBrush}"
        FontFamily="{DynamicResource MainFont}">

    <Window.Resources>
        <DropShadowEffect x:Key="CardShadow" Color="Black" Direction="315" ShadowDepth="2" BlurRadius="8" Opacity="0.2"/>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="260"/>
            <!-- LIJEVI MENI -->
            <ColumnDefinition Width="*"/>
            <!-- GLAVNI SADRŽAJ -->
        </Grid.ColumnDefinitions>

        <!-- ====================== LIJEVI VERTIKALNI MENI ====================== -->
        <Border Background="{DynamicResource PanelBackground}"
                CornerRadius="16"
                BorderBrush="#D0D0D0"
                BorderThickness="1"
                Padding="0,20">
            <StackPanel>

                <!-- Logo -->
                <TextBlock Text="Cvjećara"
                           FontSize="22"
                           FontWeight="Bold"
                           Foreground="{DynamicResource AccentBrush}"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,40"/>

                <!-- Pregled narudžbi -->
                <Button Click="PregledNarudzbi_Click"
                        Height="56" Margin="16,8"
                        Background="Transparent"
                        BorderThickness="0"
                        Cursor="Hand">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="12" Padding="16">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="&#xE8B7;" FontFamily="Segoe MDL2 Assets" FontSize="22" Margin="0,0,16,0"/>
                                    <TextBlock Text="{DynamicResource Customer_OrdersBtn}" FontWeight="Medium" FontSize="15"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#18000000"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>

                <!-- Separator -->
                <Separator Margin="20,40" Background="#E0E0E0" Height="1"/>

                <!-- Korpa -->
            
                <Button x:Name="CartButton"
        Click="OpenCart_Click"
        Height="56" Margin="16,8"
        Background="Transparent"
        BorderThickness="0"
        Cursor="Hand"
        Tag="CartBadgeHost">

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Ikona -->
                        <TextBlock Grid.Column="0"
                   Text="&#xE7BF;" 
                   FontFamily="Segoe MDL2 Assets" 
                   FontSize="22" 
                   Foreground="{DynamicResource SuccessBrush}"
                   VerticalAlignment="Center"/>

                        <!-- Tekst -->
                        <TextBlock Grid.Column="1"
                   Text="{DynamicResource Customer_CartBtn}"
                   FontWeight="Medium" 
                   FontSize="15"
                   Foreground="{DynamicResource TextBrush}"
                   Margin="16,0,0,0"
                   VerticalAlignment="Center"/>

                        <!-- Brojač – sada je direktno u Button.Content i vidi se iz C# -->
                        <TextBlock x:Name="CartCountText"
                   Grid.Column="2"
                   Text=" (0)"
                   FontWeight="Bold"
                   FontSize="13"
                   Foreground="{DynamicResource SuccessBrush}"
                   VerticalAlignment="Center"/>
                    </Grid>

                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="12" Padding="16">
                                <ContentPresenter/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#18000000"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
                <!-- Odjava -->
                <Button Click="Logout_Click"
                        Height="56" Margin="16,30,16,8"
                        Background="Transparent"
                        BorderThickness="0"
                        Cursor="Hand">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="12" Padding="16">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="&#xE7E8;" FontFamily="Segoe MDL2 Assets" FontSize="22" Margin="0,0,16,0" Foreground="{DynamicResource DangerBrush}"/>
                                    <TextBlock Text="{DynamicResource Customer_LogoutBtn}" FontWeight="Medium" FontSize="15" Foreground="{DynamicResource DangerBrush}"/>
                                </StackPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#18FF0000"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>

            </StackPanel>
        </Border>

        <!-- ====================== GLAVNI SADRŽAJ ====================== -->
        <Grid Grid.Column="1" Margin="30,0,0,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Tema + jezik -->
                <RowDefinition Height="Auto"/>
                <!-- Naslov -->
                <RowDefinition Height="Auto"/>
                <!-- Pretraga + filteri -->
                <RowDefinition Height="*"/>
                <!-- Lista proizvoda -->
            </Grid.RowDefinitions>

            <!-- Tema + jezik gore desno -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,10,0,20">
                <StackPanel Orientation="Horizontal" Margin="0,0,15,0">
                    <RadioButton x:Name="LightRadioButton" GroupName="ThemeGroup" Tag="Light" Margin="6,0" ToolTip="{DynamicResource Theme_Light}" Click="ThemeRadioButton_Click">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="22" Height="22" CornerRadius="11" Background="White" BorderBrush="#CCCCCC" BorderThickness="2">
                                    <Border x:Name="inner" Width="10" Height="10" CornerRadius="5" Background="Transparent"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsChecked" Value="True">
                                        <Setter TargetName="inner" Property="Background" Value="#333"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                    <RadioButton x:Name="PinkRadioButton" GroupName="ThemeGroup" Tag="Pink" Margin="6,0" ToolTip="{DynamicResource Theme_Pink}" Click="ThemeRadioButton_Click">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="22" Height="22" CornerRadius="11" Background="#EC4899" BorderBrush="#EC4899" BorderThickness="2">
                                    <Border x:Name="inner" Width="10" Height="10" CornerRadius="5" Background="Transparent"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsChecked" Value="True">
                                        <Setter TargetName="inner" Property="Background" Value="White"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                    <RadioButton x:Name="OceanRadioButton" GroupName="ThemeGroup" Tag="Ocean" Margin="6,0" ToolTip="{DynamicResource Theme_Ocean}" Click="ThemeRadioButton_Click">
                        <RadioButton.Template>
                            <ControlTemplate TargetType="RadioButton">
                                <Border Width="22" Height="22" CornerRadius="11" Background="#0EA5E9" BorderBrush="#0EA5E9" BorderThickness="2">
                                    <Border x:Name="inner" Width="10" Height="10" CornerRadius="5" Background="Transparent"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsChecked" Value="True">
                                        <Setter TargetName="inner" Property="Background" Value="White"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </RadioButton.Template>
                    </RadioButton>
                </StackPanel>

                <!-- Jezik -->
                <StackPanel Orientation="Horizontal">
                    <Button Content="BS" Width="40" Height="40" Margin="4" Background="{DynamicResource PanelBackground}" Foreground="{DynamicResource TextBrush}" FontWeight="Bold" Click="Lang_BS_Click" ToolTip="Bosanski">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="10" Padding="8">
                                    <ContentPresenter/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button Content="EN" Width="40" Height="40" Margin="4" Background="{DynamicResource PanelBackground}" Foreground="{DynamicResource TextBrush}" FontWeight="Bold" Click="Lang_EN_Click" ToolTip="English">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="10" Padding="8">
                                    <ContentPresenter/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>
            </StackPanel>

            <!-- Naslov -->
            <TextBlock Grid.Row="1"
                       Text="{DynamicResource Customer_Welcome}"
                       FontSize="26"
                       FontWeight="Bold"
                       Foreground="{DynamicResource TextBrush}"
                       Margin="0,0,0,20"/>

            <!-- Pretraga + filteri -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,25">
                <TextBox x:Name="SearchTextBox"
         Width="240" Height="40"
         Margin="0,0,15,0"
         FontSize="14"
         Padding="12,0"
         VerticalAlignment="Center"
         Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged, Delay=300}"
         Tag="{DynamicResource Customer_SearchPlaceholder}">

                    <TextBox.Style>
                        <Style TargetType="TextBox">
                            <Setter Property="Background" Value="White"/>
                            <Setter Property="BorderBrush" Value="#CCCCCC"/>
                            <Setter Property="BorderThickness" Value="1"/>
                            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TextBox">
                                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="10">
                                            <Grid>
                                                <ScrollViewer x:Name="PART_ContentHost" Margin="2"/>
                                                <!-- Placeholder -->
                                                <TextBlock Text="{TemplateBinding Tag}"
                                           Foreground="Gray"
                                           FontSize="14"
                                           Margin="12,0,0,0"
                                           VerticalAlignment="Center"
                                           IsHitTestVisible="False"
                                           Opacity="0.6">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource TemplatedParent}}" Value="">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource TemplatedParent}}" Value="{x:Null}">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TextBox.Style>
                </TextBox>

                <ComboBox x:Name="CategoryFilterComboBox"
                          Width="180" Height="40"
                          Margin="0,0,15,0"
                          SelectionChanged="CategoryFilterComboBox_SelectionChanged"
                          BorderBrush="#CCCCCC" BorderThickness="1"
                          FontSize="14">
                </ComboBox>

                <ComboBox x:Name="SortComboBox"
                          Width="180" Height="40"
                          SelectionChanged="SortComboBox_SelectionChanged"
                          BorderBrush="#CCCCCC" BorderThickness="1"
                          FontSize="14">
                    <ComboBoxItem Content="{DynamicResource Customer_Sort_NameAZ}" Tag="name_asc" IsSelected="True"/>
                    <ComboBoxItem Content="{DynamicResource Customer_Sort_NameZA}" Tag="name_desc"/>
                    <ComboBoxItem Content="{DynamicResource Customer_Sort_PriceLow}" Tag="price_asc"/>
                    <ComboBoxItem Content="{DynamicResource Customer_Sort_PriceHigh}" Tag="price_desc"/>
                </ComboBox>
            </StackPanel>

            <!-- Lista proizvoda -->
            <ScrollViewer Grid.Row="3" VerticalScrollBarVisibility="Auto">
                <Grid>
                    <!-- ================= LISTA PROIZVODA ================= -->
                    <ItemsControl x:Name="ProductsList"
                      Margin="0,0,0,20"
                      VirtualizingStackPanel.IsVirtualizing="True"
                      VirtualizingStackPanel.VirtualizationMode="Recycling"
                      ScrollViewer.CanContentScroll="True">

                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>

                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="12" 
                            Padding="18" 
                            Width="230"
                            Background="White"
                            BorderBrush="#E0E0E0"
                            BorderThickness="1"
                            CornerRadius="14"
                            Cursor="Hand"
                            Effect="{StaticResource CardShadow}">
                                    <StackPanel>
                                        <TextBlock Text="{Binding Naziv}"
                                       FontWeight="Bold"
                                       FontSize="16"
                                       Foreground="{DynamicResource TextBrush}"
                                       TextWrapping="Wrap"
                                       Margin="0,0,0,6"/>
                                        <TextBlock Text="{Binding KategorijaNaziv}"
                                       FontSize="13"
                                       Foreground="Gray"
                                       Margin="0,0,0,4"/>
                                        <TextBlock Text="{Binding Cijena, StringFormat='{}{0:F2} KM'}"
                                       FontSize="15"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource SuccessBrush}"
                                       Margin="0,10,0,12"/>
                                        <Button Content="{DynamicResource Customer_AddToCartBtn}"
                                    Background="{DynamicResource AccentBrush}"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Tag="{Binding}"
                                    Click="AddToCart_Click"
                                    Width="140" Height="38"
                                    FontSize="14"
                                    Cursor="Hand"
                                    HorizontalAlignment="Left">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                CornerRadius="10"
                                                Padding="12,0">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#1565C0"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <!-- ================= PRAZAN REZULTAT – LIJEPA PORUKA ================= -->
                    <Border x:Name="EmptyResultsPanel"
                Background="{DynamicResource PanelBackground}"
                CornerRadius="24"
                Padding="50"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                BorderBrush="#E0E0E0"
                BorderThickness="2"
                Visibility="Collapsed">
                        <StackPanel TextBlock.TextAlignment="Center" HorizontalAlignment="Center">
                            <!-- Lijepa ikonica (search not found) -->
                            <Path Data="M21 19L19 21L15 17V15H17L21 19ZM10 18C13.866 18 17 14.866 17 11C17 7.13401 13.866 4 10 4C6.13401 4 3 7.13401 3 11C3 14.866 6.13401 18 10 18Z"
                      Fill="#BDC3C7"
                      Width="100"
                      Height="100"
                      Stretch="Uniform"
                      Margin="0,0,0,20"/>

                            <TextBlock Text="{DynamicResource EmptyProducts_Title}"
                           FontSize="24"
                           FontWeight="SemiBold"
                           Foreground="{DynamicResource TextBrush}"
                           Margin="0,0,0,12"/>

                            <TextBlock Text="{DynamicResource EmptyProducts_Subtitle}"
                           FontSize="16"
                           Foreground="#95A5A6"
                           Opacity="0.9"
                           MaxWidth="400"
                           TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </ScrollViewer>
        </Grid>
    </Grid>
</Window>